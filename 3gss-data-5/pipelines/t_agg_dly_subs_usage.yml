variables:
  SUBS_USAGE_JOB_ARGUMENTS: --runner DataflowRunner 
      --project $DEV_PROJECT_ID 
      --staging_location gs://bt-tch-3g-sunset-dp-dev.net_mobnet_rw.t_agg_dly_staging 
      --temp_location gs://bt-dev-raw-ccn-net-mobnet-edwh-t-agg-dly-subs-usage/temp 
      --template_location gs://bt-dev-net-mobnet-proc-dataflows/templates/t_agg_dly_subs_usage.json
      --region $DEV_REGION 
      --no_use_public_ips 
      --output gs://bt-dev-cleansed-ccn-net-mobnet-edwh-agg-mth-subs-usage/subs_usage_clean
      --input gs://bt-dev-raw-ccn-net-mobnet-edwh-agg-mth-subs-usage/*.gz
      --input_file_headers DATE_OF_CALL,MSISDN,EXBR_ACCOUNT_NUM,CSS_ACCOUNT_ID,JT_CUSTOMER_ID,SUBSCRIPTION_SK,IMEI,IMSI,FIRST_CELL_DATA_ID,LAST_CELL_DATA_ID,HOME_MO_COUNT,HOME_MT_COUNT,HOME_MO_SMS_COUNT,HOME_MT_SMS_COUNT,HOME_MO_DURATION_SECS,HOME_MT_DURATION_SECS,HOME_DATA_IN_VOLUME_KB,WORK_MO_COUNT,WORK_MT_COUNT,WORK_MO_SMS_COUNT,WORK_MT_SMS_COUNT,WORK_MO_DURATION_SECS,WORK_MT_DURATION_SECS,WORK_DATA_IN_VOLUME_KB,CNT_OF_DISTINCT_BNUMBER,HOME_DATA_SESSION_COUNT,HOME_DATA_OUT_VOLUME_KB,WORK_DATA_SESSION_COUNT,WORK_DATA_OUT_VOLUME_KB,HOME_MO_DROPCALLS_COUNT,HOME_MT_DROPCALLS_COUNT,WORK_MO_DROPCALLS_COUNT,WORK_MT_DROPCALLS_COUNT,HOME_MO_CE_DROPCALLS_COUNT,HOME_MT_CE_DROPCALLS_COUNT,WORK_MO_CE_DROPCALLS_COUNT,WORK_MT_CE_DROPCALLS_COUNT,HOME_ABNORMAL_SESSION_COUNT,WORK_ABNORMAL_SESSION_COUNT,HOME_DATA_DURATION_SECS,WORK_DATA_DURATION_SECS,MO_HANDOFF_CELL_COUNT,MT_HANDOFF_CELL_COUNT,MO_HANDOFF_TECHNOLOGY_COUNT,MT_HANDOFF_TECHNOLOGY_COUNT,MO_HANDOFF_MNC_COUNT,MT_HANDOFF_MNC_COUNT,HOME_CSD_DURATION_SECS,WORK_CSD_DURATION_SECS,HOME_MT_dDROPCALLS_RAN_COUNT,HOME_MT_DROPCALLS_CORE_COUNT,WORK_MT_DROPCALLS_RAN_COUNT,WORK_MT_DROPCALLS_CORE_COUNT,HOME_MO_DROPCALLS_RAN_COUNT,HOME_MO_DROPCALLS_CORE_COUNT,WORK_MO_DROPCALLS_RAN_COUNT,WORK_MO_DROPCALLS_CORE_COUNT,PROCESS_RUN_SEQUENCE,RECORD_TS
      --output_file_header CALL_DATE,DATE_OF_CALL,MSISDN,EXBR_ACCOUNT_NUM,CSS_ACCOUNT_ID,JT_CUSTOMER_ID,SUBSCRIPTION_SK,IMEI,IMSI,FIRST_CELL_DATA_ID,LAST_CELL_DATA_ID,HOME_MO_COUNT,HOME_MT_COUNT,HOME_MO_SMS_COUNT,HOME_MT_SMS_COUNT,HOME_MO_DURATION_SECS,HOME_MT_DURATION_SECS,HOME_DATA_IN_VOLUME_KB,WORK_MO_COUNT,WORK_MT_COUNT,WORK_MO_SMS_COUNT,WORK_MT_SMS_COUNT,WORK_MO_DURATION_SECS,WORK_MT_DURATION_SECS,WORK_DATA_IN_VOLUME_KB,CNT_OF_DISTINCT_BNUMBER,HOME_DATA_SESSION_COUNT,HOME_DATA_OUT_VOLUME_KB,WORK_DATA_SESSION_COUNT,WORK_DATA_OUT_VOLUME_KB,HOME_MO_DROPCALLS_COUNT,HOME_MT_DROPCALLS_COUNT,WORK_MO_DROPCALLS_COUNT,WORK_MT_DROPCALLS_COUNT,HOME_MO_CE_DROPCALLS_COUNT,HOME_MT_CE_DROPCALLS_COUNT,WORK_MO_CE_DROPCALLS_COUNT,WORK_MT_CE_DROPCALLS_COUNT,HOME_ABNORMAL_SESSION_COUNT,WORK_ABNORMAL_SESSION_COUNT,HOME_DATA_DURATION_SECS,WORK_DATA_DURATION_SECS,MO_HANDOFF_CELL_COUNT,MT_HANDOFF_CELL_COUNT,MO_HANDOFF_TECHNOLOGY_COUNT,MT_HANDOFF_TECHNOLOGY_COUNT,MO_HANDOFF_MNC_COUNT,MT_HANDOFF_MNC_COUNT,HOME_CSD_DURATION_SECS,WORK_CSD_DURATION_SECS,HOME_MT_dDROPCALLS_RAN_COUNT,HOME_MT_DROPCALLS_CORE_COUNT,WORK_MT_DROPCALLS_RAN_COUNT,WORK_MT_DROPCALLS_CORE_COUNT,HOME_MO_DROPCALLS_RAN_COUNT,HOME_MO_DROPCALLS_CORE_COUNT,WORK_MO_DROPCALLS_RAN_COUNT,WORK_MO_DROPCALLS_CORE_COUNT,PROCESS_RUN_SEQUENCE,RECORD_TS
      --primary_key CALL_DATE
      --setup_file dataflows/setup.py
      --save_main_session